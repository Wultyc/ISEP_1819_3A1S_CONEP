#setwd(dir)
#import de bibliotecas
library(readxl)
#dados guardados no excel
dados_trabalho = read_excel("dados_trabalho.xlsx")
#View(dados_trabalho)
#Media de cada amostra
media.linha <- apply(dados_trabalho[1:50,2:4], 1, mean)
#View(media.linha)
#Media Geral
media.global <- mean(unlist(media.linha))
media.global
#Numero de amostras
N <- NROW(media.linha)
LCL <- 6
UCL <- 8
CL <- 7
plot(media.linha,type = "b", main="Carta de Controlo", xlab = "Numero da Amostra", ylab = "Espessura do Vidro", ylim=c(LCL-0.5, UCL+0.5))
lines(rep(UCL,N), col="red")
lines(rep(LCL,N), col="red")
lines(rep(CL,N), col="blue")
View(dados_trabalho)
media.linha
#limpa o ambiente do R
rm(list=ls())
#Seed do script
set.seed(492365)
#Define o diretório de trabalho
#dir <- getScriptPath()
#dir
#setwd(dir)
#import de bibliotecas
library(readxl)
#dados guardados no excel
dados_trabalho = read_excel("dados_trabalho.xlsx")
#View(dados_trabalho)
#Media de cada amostra
media.linha <- apply(dados_trabalho[1:50,2:4], 1, mean)
#View(media.linha)
#Media Geral
media.global <- mean(unlist(media.linha))
media.global
#Numero de amostras
N <- NROW(media.linha)
LCL <- 6
UCL <- 8
CL <- 7
ucl < rep(UCL,N)
lcl < rep(LCL,N)
cl < rep(CL,N)
plot(media.linha,type = "b", main="Carta de Controlo", xlab = "Numero da Amostra", ylab = "Espessura do Vidro", ylim=c(LCL-0.5, UCL+0.5))
lines(ucl, col="red")
lines(lcl, col="red")
lines(cl, col="blue")
#Existe um ponto fora dos limites
#É necessário remover o ponto 8
fora.lim = media.linha > UC
#aux <-
#limpa o ambiente do R
rm(list=ls())
#Seed do script
set.seed(492365)
#Define o diretório de trabalho
#dir <- getScriptPath()
#dir
#setwd(dir)
#import de bibliotecas
library(readxl)
#dados guardados no excel
dados_trabalho = read_excel("dados_trabalho.xlsx")
#View(dados_trabalho)
#Media de cada amostra
media.linha <- apply(dados_trabalho[1:50,2:4], 1, mean)
#View(media.linha)
#Media Geral
media.global <- mean(unlist(media.linha))
media.global
#Numero de amostras
N <- NROW(media.linha)
LCL <- 6
UCL <- 8
CL <- 7
ucl <- c(rep(UCL,N))
lcl <- c(rep(LCL,N))
cl <- c(rep(CL,N))
plot(media.linha,type = "b", main="Carta de Controlo", xlab = "Numero da Amostra", ylab = "Espessura do Vidro", ylim=c(LCL-0.5, UCL+0.5))
lines(ucl, col="red")
lines(lcl, col="red")
lines(cl, col="blue")
#Existe um ponto fora dos limites
#É necessário remover o ponto 8
#fora.lim = media.linha > UC
#aux <-
fora.lim = media.linha > ucl || media.linha < lcl
fora.lim <- media.linha > ucl || media.linha < lcl
fora.lim <- media.linha > ucl
fora.lim1 <- media.linha > ucl
fora.lim2 <- media.linha < lcl
fora.lim = fora.lim1 + fora.lim2
fora.lim
fora.lim1 <- media.linha > ucl
fora.lim2 <- media.linha < lcl
fora.lim = fora.lim1 + fora.lim2
aux <- c[fora.lim]
aux <- c[fora.lim]
aux <- max(c[fora.lim])
aux <- min(c[fora.lim])
fora.lim1 <- media.linha > ucl || media.linha < lcl
#limpa o ambiente do R
rm(list=ls())
#Seed do script
set.seed(492365)
#Define o diretório de trabalho
#dir <- getScriptPath()
#dir
#setwd(dir)
#import de bibliotecas
library(readxl)
#dados guardados no excel
dados_trabalho = read_excel("dados_trabalho.xlsx")
#View(dados_trabalho)
#Media de cada amostra
media.linha <- apply(dados_trabalho[1:50,2:4], 1, mean)
#View(media.linha)
#Media Geral
media.global <- mean(unlist(media.linha))
media.global
#Numero de amostras
N <- NROW(media.linha)
LCL <- 6
UCL <- 8
CL <- 7
ucl <- c(rep(UCL,N))
lcl <- c(rep(LCL,N))
cl <- c(rep(CL,N))
plot(media.linha,type = "b", main="Carta de Controlo", xlab = "Numero da Amostra", ylab = "Espessura do Vidro", ylim=c(LCL-0.5, UCL+0.5))
lines(ucl, col="red")
lines(lcl, col="red")
lines(cl, col="blue")
#Existe um ponto fora dos limites
#É necessário remover o ponto 8
fora.lim <- media.linha > ucl || media.linha < lcl
#aux <- min(c[fora.lim])
fora.lim <- media.linha > ucl[] || media.linha < lcl[]
aux <- min(c[fora.lim])
aux <- min(fora.lim[])
fora.lim1 <- media.linha > ucl
fora.lim2 <- media.linha < lcl
fora.lim <- fora.lim1 + fora.lim2
aux <- min(c[fora.lim])
aux
fora.lim
ucl <- rep(UCL,N)
lcl <- rep(LCL,N)
cl <- rep(CL,N)
#limpa o ambiente do R
rm(list=ls())
#Seed do script
set.seed(492365)
#Define o diretório de trabalho
#dir <- getScriptPath()
#dir
#setwd(dir)
#import de bibliotecas
library(readxl)
#dados guardados no excel
dados_trabalho = read_excel("dados_trabalho.xlsx")
#View(dados_trabalho)
#Media de cada amostra
media.linha <- apply(dados_trabalho[1:50,2:4], 1, mean)
#View(media.linha)
#Media Geral
media.global <- mean(unlist(media.linha))
media.global
#Numero de amostras
N <- NROW(media.linha)
LCL <- 6
UCL <- 8
CL <- 7
ucl <- rep(UCL,N)
lcl <- rep(LCL,N)
cl <- rep(CL,N)
plot(media.linha,type = "b", main="Carta de Controlo", xlab = "Numero da Amostra", ylab = "Espessura do Vidro", ylim=c(LCL-0.5, UCL+0.5))
lines(ucl, col="red")
lines(lcl, col="red")
lines(cl, col="blue")
#Existe um ponto fora dos limites
#É necessário remover o ponto 8
fora.lim1 <- media.linha > ucl
fora.lim2 <- media.linha < lcl
fora.lim <- fora.lim1 + fora.lim2
aux <- min(c[fora.lim])
aux <- min(fora.lim[]])
aux <- min(fora.lim[])
aux
aux <- max(fora.lim[])
aux
aux <- c[fora.lim]
fora.lim
aux <- max(c[fora.lim])
aux <- match(fora.lim,1)
aux
aux <- fora.lim == 1
fora.lim
?which
?getIndex
which(fora.lim == 1)
aux <- which(fora.lim == 1)
aux
setdiff(media.linha,aux)
View(dados_trabalho)
View(dados_trabalho)
#Media de cada amostra
media.linha <- apply(dados_trabalho[,2:4], 1, mean)
#limpa o ambiente do R
rm(list=ls())
#Seed do script
set.seed(492365)
#Define o diretório de trabalho
#dir <- getScriptPath()
#dir
#setwd(dir)
#import de bibliotecas
library(readxl)
#dados guardados no excel
dados_trabalho = read_excel("dados_trabalho.xlsx")
#View(dados_trabalho)
#Media de cada amostra
media.linha <- apply(dados_trabalho[,2:4], 1, mean)
#View(media.linha)
#Media Geral
media.global <- mean(unlist(media.linha))
media.global
#Numero de amostras
N <- NROW(media.linha)
LCL <- 6
UCL <- 8
CL <- 7
ucl <- rep(UCL,N)
lcl <- rep(LCL,N)
cl <- rep(CL,N)
plot(media.linha,type = "b", main="Carta de Controlo", xlab = "Numero da Amostra", ylab = "Espessura do Vidro", ylim=c(LCL-0.5, UCL+0.5))
lines(ucl, col="red")
lines(lcl, col="red")
lines(cl, col="blue")
#Existe um ponto fora dos limites
#É necessário remover o ponto 8
fora.lim1 <- media.linha > ucl
fora.lim2 <- media.linha < lcl
fora.lim <- fora.lim1 + fora.lim2
idx.fora <- which(fora.lim == 1)
idx.fora
idx.fora <- which(fora.lim == 1)
media.linha <- media.linha[-idx.fora]
media.linha
#limpa o ambiente do R
rm(list=ls())
#Seed do script
set.seed(492365)
#Define o diretório de trabalho
#dir <- getScriptPath()
#dir
#setwd(dir)
#import de bibliotecas
library(readxl)
#dados guardados no excel
dados_trabalho = read_excel("dados_trabalho.xlsx")
#View(dados_trabalho)
#Media de cada amostra
media.linha <- apply(dados_trabalho[1:50,2:4], 1, mean)
View(media.linha)
#Media Geral
media.global <- mean(unlist(media.linha))
media.global
#Numero de amostras
N <- NROW(media.linha)
LCL <- 6
UCL <- 8
CL <- 7
ucl <- rep(UCL,N)
lcl <- rep(LCL,N)
cl <- rep(CL,N)
plot(media.linha,type = "b", main="Carta de Controlo", xlab = "Numero da Amostra", ylab = "Espessura do Vidro", ylim=c(LCL-0.5, UCL+0.5))
lines(ucl, col="red")
lines(lcl, col="red")
lines(cl, col="blue")
#Existe um ponto fora dos limites
#É necessário remover o ponto 8
#determina quais os valores fora dos limites
fora.lim1 <- media.linha > ucl
fora.lim2 <- media.linha < lcl
fora.lim <- fora.lim1 + fora.lim2
#encontra os indices
idx.fora <- which(fora.lim == 1)
#remove os indices indicados
media.linha <- media.linha[-idx.fora]
#calcula uma nova média global
media.global <- mean(unlist(media.linha))
media.global
#limpa o ambiente do R
rm(list=ls())
#Seed do script
set.seed(492365)
#Define o diretório de trabalho
#dir <- getScriptPath()
#dir
#setwd(dir)
#import de bibliotecas
library(readxl)
#dados guardados no excel
dados_trabalho = read_excel("dados_trabalho.xlsx")
#View(dados_trabalho)
#Media de cada amostra
media.linha <- apply(dados_trabalho[1:50,2:4], 1, mean)
View(media.linha)
#Media Geral
media.global <- mean(unlist(media.linha))
media.global
#Numero de amostras
N <- NROW(media.linha)
LCL <- 6
UCL <- 8
CL <- 7
ucl <- rep(UCL,N)
lcl <- rep(LCL,N)
cl <- rep(CL,N)
plot(media.linha,type = "b", main="Carta de Controlo", xlab = "Numero da Amostra", ylab = "Espessura do Vidro", ylim=c(LCL-0.5, UCL+0.5))
lines(ucl, col="red")
lines(lcl, col="red")
lines(cl, col="blue")
#Existe um ponto fora dos limites
#É necessário remover o ponto 8
#determina quais os valores fora dos limites
fora.lim1 <- media.linha > ucl
fora.lim2 <- media.linha < lcl
fora.lim <- fora.lim1 + fora.lim2
#encontra os indices
idx.fora <- which(fora.lim == 1)
#remove os indices indicados
media.linha <- media.linha[-idx.fora]
#calcula uma nova média global
media.global <- mean(unlist(media.linha))
media.global
#Apresenta o novo gráfico
plot(media.linha,type = "b", main="Carta de Controlo", xlab = "Numero da Amostra", ylab = "Espessura do Vidro", ylim=c(LCL-0.5, UCL+0.5))
lines(ucl, col="red")
lines(lcl, col="red")
lines(cl, col="blue")
#limpa o ambiente do R
rm(list=ls())
#Seed do script
set.seed(492365)
#Constantes
A2 <- 0.729
#Define o diretório de trabalho
#dir <- getScriptPath()
#dir
#setwd(dir)
#import de bibliotecas
library(readxl)
#dados guardados no excel
dados_trabalho = read_excel("dados_trabalho.xlsx")
#View(dados_trabalho)
#Media
media.linha <- apply(dados_trabalho[1:50,2:4], 1, mean)
#View(media.linha)
media.global <- mean(unlist(media.linha))
media.global
#Amplitude
amplitude.linha <- apply(dados_trabalho[1:50,2:4], 1, max) - apply(dados_trabalho[1:50,2:4], 1, min)
amplitude.media <- mean(amplitude.linha)
#Carta X
UCL.x <- media.global + A2 * amplitude.media
LCL.x <- media.global - A2 * amplitude.media
CL.x  <- media.global
plot(media.linha,type = "b", main="Carta de Controlo X", xlab = "Numero da Amostra", ylab = "Espessura do Vidro", ylim=c(LCL-0.5, UCL+0.5))
lines(rep(UCL.x, N), col="red")
lines(rep(LCL.x, N), col="red")
lines(rep(CL.x, N), col="blue")
#limpa o ambiente do R
rm(list=ls())
#Seed do script
set.seed(492365)
#Constantes
A2 <- 0.729
#Define o diretório de trabalho
#dir <- getScriptPath()
#dir
#setwd(dir)
#import de bibliotecas
library(readxl)
#dados guardados no excel
dados_trabalho = read_excel("dados_trabalho.xlsx")
#View(dados_trabalho)
#Media
media.linha <- apply(dados_trabalho[1:50,2:4], 1, mean)
#View(media.linha)
media.global <- mean(unlist(media.linha))
media.global
#Amplitude
amplitude.linha <- apply(dados_trabalho[1:50,2:4], 1, max) - apply(dados_trabalho[1:50,2:4], 1, min)
amplitude.media <- mean(amplitude.linha)
#Carta X
UCL.x <- media.global + A2 * amplitude.media
LCL.x <- media.global - A2 * amplitude.media
CL.x  <- media.global
plot(media.linha,type = "b", main="Carta de Controlo X", xlab = "Numero da Amostra", ylab = "Espessura do Vidro", ylim=c(LCL-0.5, UCL+0.5))
lines(rep(UCL.x, N), col="red")
lines(rep(LCL.x, N), col="red")
lines(rep(CL.x, N), col="blue")
N <- NROW(dados_trabalho[1])
#limpa o ambiente do R
rm(list=ls())
#Seed do script
set.seed(492365)
#Constantes
A2 <- 0.729
#Define o diretório de trabalho
#dir <- getScriptPath()
#dir
#setwd(dir)
#import de bibliotecas
library(readxl)
#dados guardados no excel
dados_trabalho = read_excel("dados_trabalho.xlsx")
N <- NROW(dados_trabalho[1])
#View(dados_trabalho)
#Media
media.linha <- apply(dados_trabalho[1:N,2:4], 1, mean)
#View(media.linha)
media.global <- mean(unlist(media.linha))
media.global
#Amplitude
amplitude.linha <- apply(dados_trabalho[1:N,2:4], 1, max) - apply(dados_trabalho[1:N,2:4], 1, min)
amplitude.media <- mean(amplitude.linha)
#Carta X
UCL.x <- media.global + A2 * amplitude.media
LCL.x <- media.global - A2 * amplitude.media
CL.x  <- media.global
plot(media.linha,type = "b", main="Carta de Controlo X", xlab = "Numero da Amostra", ylab = "Espessura do Vidro", ylim=c(LCL-0.5, UCL+0.5))
lines(rep(UCL.x, N), col="red")
lines(rep(LCL.x, N), col="red")
lines(rep(CL.x, N), col="blue")
#limpa o ambiente do R
rm(list=ls())
#Seed do script
set.seed(492365)
#Constantes
A2 <- 0.729
#Define o diretório de trabalho
#dir <- getScriptPath()
#dir
#setwd(dir)
#import de bibliotecas
library(readxl)
#dados guardados no excel
dados_trabalho = read_excel("dados_trabalho.xlsx")
N <- NROW(dados_trabalho[1])
#View(dados_trabalho)
#Media
media.linha <- apply(dados_trabalho[1:N,2:4], 1, mean)
#View(media.linha)
media.global <- mean(unlist(media.linha))
media.global
#Amplitude
amplitude.linha <- apply(dados_trabalho[1:N,2:4], 1, max) - apply(dados_trabalho[1:N,2:4], 1, min)
amplitude.media <- mean(amplitude.linha)
#Carta X
UCL.x <- media.global + A2 * amplitude.media
LCL.x <- media.global - A2 * amplitude.media
CL.x  <- media.global
plot(media.linha,type = "b", main="Carta de Controlo X", xlab = "Numero da Amostra", ylab = "Espessura do Vidro", ylim=c(LCL.x-0.5, UCL.x+0.5))
lines(rep(UCL.x, N), col="red")
lines(rep(LCL.x, N), col="red")
lines(rep(CL.x, N), col="blue")
plot(media.linha,type = "b", main="Carta de Controlo X", xlab = "Numero da Amostra", ylab = "Espessura do Vidro")
lines(rep(UCL.x, N), col="red")
lines(rep(LCL.x, N), col="red")
lines(rep(CL.x, N), col="blue")
View(dados_trabalho)
#limpa o ambiente do R
rm(list=ls())
#Seed do script
set.seed(492365)
#Constantes
A2 <- 0.729
#Define o diretório de trabalho
#dir <- getScriptPath()
#dir
#setwd(dir)
#import de bibliotecas
library(readxl)
#dados guardados no excel
dados_trabalho = read_excel("dados_trabalho.xlsx")
N <- NROW(dados_trabalho[1])
#View(dados_trabalho)
#Media
media.linha <- apply(dados_trabalho[1:N,2:5], 1, mean)
#View(media.linha)
media.global <- mean(unlist(media.linha))
media.global
#Amplitude
amplitude.linha <- apply(dados_trabalho[1:N,2:5], 1, max) - apply(dados_trabalho[1:N,2:5], 1, min)
amplitude.media <- mean(amplitude.linha)
#Carta X
UCL.x <- media.global + A2 * amplitude.media
LCL.x <- media.global - A2 * amplitude.media
CL.x  <- media.global
plot(media.linha,type = "b", main="Carta de Controlo X", xlab = "Numero da Amostra", ylab = "Espessura do Vidro")
lines(rep(UCL.x, N), col="red")
lines(rep(LCL.x, N), col="red")
lines(rep(CL.x, N), col="blue")
